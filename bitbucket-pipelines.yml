image: uber/android-build-environment:latest

pipelines:
  branches:
    production:
      - step:
          script:
            - mkdir "${ANDROID_HOME}/licenses" || true
            -  echo "d56f5187479451eabf01fb78af6dfcb131a6481e" > "${ANDROID_HOME}/licenses/android-sdk-license"
            - ./gradlew alax:assembleRelease --stacktrace
            - ./gradlew generateChangelog alax:init alax:uploadToHockeyApp
    develop:
      - step:
          script:
            - mkdir "${ANDROID_HOME}/licenses" || true
            -  echo "d56f5187479451eabf01fb78af6dfcb131a6481e" > "${ANDROID_HOME}/licenses/android-sdk-license"
            - ./gradlew alax:assembleRelease --stacktrace
            - ./gradlew generateChangelog alax:init alax:uploadStageDebugToHockeyApp alax:uploadProdReleaseToHockeyApp
